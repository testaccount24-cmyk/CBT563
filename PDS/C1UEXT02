000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.    C1UEXT02.
000300 AUTHOR. R THORNTON
000400*****************************************************************
000500*REMARKS. C1UEXT02 IS AN ENDEVOR EXIT PROGRAM THAT IS INVOKED BY*
000600*         THE ENDEVOR INTERFACE PROGRAM, EPC1UEXT, WHICH CALLS  *
000700*         THIS EXIT, PASSING SEVERAL ENDEVOR CONTROL BLOCKS     *
000800*         BEFORE ENDEVOR EXECUTES ANY OF THE FOLLOWING ACTIONS: *
000900*                ADD, UPDATE, RETRIEVE, GENERATE,               *
001000*                MOVE, DELETE, SIGNIN, TRANSFER,                *
001100*                ARCHIVE, AND RESTORE.                          *
001200*     PURPOSE: THIS EXIT WILL TEST FOR OVERRIDE TO A PREVIOUS   *
001300*         SIGNOUT. WHEN THIS OCCURS, THE ORIGINAL OWNER WILL BE *
001400*         SENT AN EMAIL NOTIFYING THEM THAT THE SIGHOUT OVERRIDE*
001500*         OCCURRED, AND WILL GIVE THE LOGON ID OF THE OVERRIDER.*
001600*     NOTES: C1UEXT02 USES THE COBOL COPY BOOK SUPPLIED BY      *
001700*         ENDEVOR AS SPP.ENDEVOR.V3R9M1.SOURCE(EXITBLKS) TO     *
001800*         DEFINE THE CONTROL BLOCKS PASSED IN THE LINKAGE       *
001900*         SECTION OF THIS PROGRAM.                              *
002000*         (2) THE LOAD MODULE FOR THIS PROGRAM MUST BE LINKED   *
002100*         WITH EPC1UEXT AS THE ENTRY POINT, AND THE LOAD        *
002200*         MODULE MUST BE IN SPP.ENDEVOR.V3R9M1.CONLIB(C1UEXT02) *
002300*         (3) THE C1UEXT02 EXIT MUST BE IDENTIFIED TO ENDEVOR   *
002400*         BY INCLUDING IT IN THE C1UEXITS TABLE.                *
002500*****************************************************************
002600 ENVIRONMENT DIVISION.
002700 CONFIGURATION SECTION.
002800 INPUT-OUTPUT SECTION.
002900 FILE-CONTROL.
003000 DATA DIVISION.
003100 FILE SECTION.
003200 WORKING-STORAGE SECTION.
003300 77  FILLER PIC X(36)  VALUE
003400     'C1UEXT02 WORKING STORAGE BEGINS HERE'.
003410 01  EMAIL-MESSAGE.
003420     05  CURRENT-OWNER-USERID       PIC X(8).
003430     05  FILLER                     PIC X(29) VALUE
003440                ': THIS IS TO INFORM YOU THAT '.
003450     05  SIGNOUT-USERID             PIC X(8).
003460     05  FILLER                     PIC X(41) VALUE
003470                ' HAS OVERRIDDEN YOUR SIGNOUT FOR ELEMENT '.
003480     05  ELEMENT-NAME               PIC X(8).
003490     05  FILLER                     PIC X(16) VALUE
003491                ' IN ENVIRONMENT '.
003492     05  ENVIRONMENT-NAME           PIC X(8).
003493     05  FILLER                     PIC X(9) VALUE
003494                ', SYSTEM '.
003495     05  SYSTEM-NAME               PIC X(8).
003496     05  FILLER                    PIC X(12) VALUE
003497                ', SUBSYSTEM '.
003498     05  SUBSYSTEM-NAME            PIC X(8).
003499     05  FILLER                    PIC X VALUE '.'.
003500*
003510 LINKAGE SECTION.
003600*    COPY EXITBLKS.
003700 01  EXIT-CONTROL-BLOCK.
003800     05  ECB-LENGTH              PIC 9(4) COMP SYNC.
003900     05  ECB-CURRENT-VERSION     PIC 9(4) COMP SYNC.
004000     05  ECB-BLOCK-ID            PIC X(4).
004100     05  ECB-FLAG                PIC 9(8) COMP SYNC.
004200     05  ECB-RETURN-CODE         PIC 9(8) COMP SYNC.
004300         88  RETURN-OK           VALUE 0.
004400         88  RETURN-OK-MODS      VALUE 4.
004500         88  RETURN-ABORT        VALUE 8.
004600     05  ECB-ARGUMENTS           PIC 9(8) COMP SYNC.
004700     05  ECB-EXIT-NUMBER         PIC 9(8) COMP SYNC.
004800         88  C1IEXT01            VALUE 1.
004900         88  C1IEXT02            VALUE 2.
005000         88  C1IEXT03            VALUE 3.
005100         88  C1IEXT04            VALUE 4.
005200         88  C1IEXT05            VALUE 5.
005300         88  C1IEXT06            VALUE 6.
005400     05  ECB-USER-ID             PIC X(8).
005500     05  ECB-TSO-BATCH-MODE      PIC X.
005600         88  TSO                 VALUE 'T'.
005700         88  BATCH               VALUE 'B'.
005800     05  ECB-CALL-FLAG           PIC X.
005900         88  INTERNAL-CALL       VALUE 'Y'.
006000         88  ACTION-CALL         VALUE 'N'.
006100     05  ECB-SMF-FLAG            PIC X.
006200         88  SMF-ENABLED         VALUE 'Y'.
006300         88  SMF-DISABLED        VALUE 'N'.
006400     05  ECB-SMF-WRITE-FLAG      PIC X.
006500         88  SMF-WRITE-BUFFER    VALUE 'Y'.
006600         88  SMF-NO-WRITE-BUF    VALUE 'N'.
006700     05  ECB-ACTION-CODE         PIC 9(8) COMP SYNC.
006800         88  ADD-ACTION          VALUE 1.
006900         88  UPDATE-ACTION       VALUE 2.
007000         88  RETRIEVE-ACTION     VALUE 3.
007100         88  DELETE-ACTION       VALUE 4.
007200         88  GENERATE-ACTION     VALUE 5.
007300         88  DISPLAY-ACTION      VALUE 6.
007400         88  MOVE-ACTION         VALUE 7.
007500         88  ARCHIVE-ACTION      VALUE 8.
007600         88  SIGNIN-ACTION       VALUE 12.
007700         88  SO-OVERRIDE-ACTION  VALUE 13.
007800         88  ENV-MGR-ACTION      VALUE 14.
007900         88  PRINT-ACTION        VALUE 15.
008000         88  TRANSFER-ACTION     VALUE 16.
008100         88  RESTORE-ACTION      VALUE 18.
008200     05  ECB-ACTION-NAME         PIC X(8).
008300     05  ECB-MESSAGE-CODE        PIC X(4).
008400     05  ECB-MESSAGE-LENGTH      PIC 9(4) COMP SYNC.
008500     05  ECB-MESSAGE-TEXT        PIC X(132).
008600     05  ECB-CALLER-ORIGIN       PIC X(1).
008700         88  CALLER-ENDEVOR      VALUE 'E'.
008800         88  CALLER-QUICKEDIT    VALUE 'Q'.
008900     05  FILLER                  PIC X(1).
009000     05  ECB-REQUEST-POINTER     PIC 9(8) COMP SYNC.
009100     05  ECB-PANEL-TYPE          PIC 9(8) COMP SYNC.
009200         88  NO-PANEL-INFO       VALUE 0.
009300         88  ENVIRONMENT-PANEL   VALUE 1.
009400         88  MAIN-PANEL          VALUE 2.
009500         88  FOREGROUND-PANEL    VALUE 3.
009600     05  ECB-EXIT-HOLD-FIELD     PIC 9(8) COMP SYNC.
009700     05  ECB-SECURITY-FUNCTION   PIC 9(8) COMP SYNC.
009800     05  ECB-HIGH-RC             PIC 9(8) COMP SYNC.
009900*
010000*
010100*
010200 01  REQUEST-INFO-BLOCK.
010300     05  REQ-LENGTH              PIC 9(4) COMP SYNC.
010400     05  REQ-CURRENT-VERSION     PIC 9(4) COMP SYNC.
010500     05  REQ-BLOCK-ID            PIC X(4).
010600     05  REQ-CCID                PIC X(12).
010700     05  REQ-COMMENT             PIC X(40).
010800     05  REQ-REQUEST-FLAG        PIC 9(8) COMP SYNC.
010900     05  REQ-SISO-INDICATOR      PIC X.
011000         88  SIGNOUT-OVERRIDE    VALUE 'Y'.
011100         88  NO-SIGNOUT-OVERRIDE VALUE 'N'.
011200     05  REQ-COPY-INDICATOR      PIC X.
011300         88  RETRIEVE-COPY-ONLY  VALUE 'Y'.
011400         88  RETRIEVE-FOR-UPDATE VALUE 'N'.
011500     05  REQ-EXPINCL-INDICATOR   PIC X.
011600         88  EXPAND-INCLUDES     VALUE 'Y'.
011700         88  NO-EXPAND-INCLUDES  VALUE 'N'.
011800     05  REQ-OVERWRITE-INDICATOR PIC X.
011900         88  WRITE-OVER-MEMBER    VALUE 'Y'.
012000         88  NO-WRITE-OVER-MEMBER VALUE 'N'.
012100     05  REQ-ACTION-RC           PIC 9(8) COMP SYNC.
012200     05  REQ-NEW-VERSION         PIC X(2).
012300     05  REQ-GEN-COPYBACK        PIC X.
012400         88  GEN-COPYBACK           VALUE 'Y'.
012500         88  NO-GEN-COPYBACK        VALUE 'N'.
012600     05  FILLER                  PIC X(5).
012700     05  REQ-DELETE-AFTER        PIC X.
012800         88  DELETE-AFTER-ACTION    VALUE 'Y'.
012900         88  NO-DELETE-AFTER-ACTION VALUE 'N'.
013000     05  REQ-MOVE-WITH-HISTORY   PIC X.
013100         88  MOVE-WITH-HISTORY    VALUE 'Y'.
013200         88  MOVE-WITHOUT-HISTORY VALUE 'N'.
013300     05  REQ-ADD-WITH-UPDATE     PIC X.
013400         88  ADD-WITH-UPDATE     VALUE 'Y'.
013500         88  ADD-WITHOUT-UPDATE  VALUE 'N'.
013600     05  REQ-BYPASS-GEN-PROC     PIC X.
013700         88  BYPASS-GEN-PROC     VALUE 'Y'.
013800         88  NO-BYPASS-GEN-PROC  VALUE 'N'.
013900     05  REQ-DEL-COMPS-ONLY      PIC X.
014000         88  DEL-COMPS-ONLY      VALUE 'Y'.
014100         88  NO-DEL-COMPS-ONLY   VALUE 'N'.
014200     05  REQ-SYNCHRONIZE         PIC X.
014300         88  YES-SYNCHRONIZE     VALUE 'Y'.
014400         88  NO-SYNCHRONIZE      VALUE 'N'.
014500     05  REQ-IGNGEN-FAIL         PIC X.
014600         88  IGNORE-GEN-FAIL     VALUE 'Y'.
014700         88  NO-INGORE-GEN-FAIL  VALUE 'N'.
014800     05  REQ-BYPASS-DEL-PROC     PIC X.
014900         88  BYPASS-DEL-PROC     VALUE 'Y'.
015000         88  NO-BYPASS-DEL-PROC  VALUE 'N'.
015100     05  REQ-PROCESSOR-GROUP     PIC X(8).
015200     05  REQ-SIGNOUT-USRID       PIC X(8).
015300     05  REQ-SEARCH-OPTION       PIC X.
015400         88  SEARCH-ENV-MAP      VALUE 'Y'.
015500         88  NO-SEARCH-ENV-MAP   VALUE 'N'.
015600     05  REQ-RETAIN-SIGNOUT-OPT  PIC X.
015700         88  RETAIN-SIGNOUT      VALUE 'Y'.
015800         88  NO-RETAIN-SIGNOUT   VALUE 'N'.
015900     05  REQ-JUMP-OPTION         PIC X.
016000         88  JUMP-IS-OK          VALUE 'Y'.
016100         88  NO-JUMP-SPECIFIED   VALUE 'N'.
016200     05  REQ-SIGNIN-OPTION       PIC X.
016300         88  SIGNIN-IS-SPECIFIED VALUE 'Y'.
016400         88  NO-SIGNIN-SPECIFIED VALUE 'N'.
016500*
016600*
016700*
016800 01  SRC-ENVIRONMENT-BLOCK.
016900     05  SRC-ENV-LENGTH              PIC 9(4) COMP SYNC.
017000     05  SRC-ENV-CURRENT-VERSION     PIC 9(4) COMP SYNC.
017100     05  SRC-ENV-BLOCK-ID            PIC X(4).
017200     05  SRC-ENV-FLAGS               PIC 9(4) COMP SYNC.
017300     05  SRC-ENV-TYPE-OF-BLOCK       PIC X.
017400         88  SRC-INTERNAL-C1-BLOCK   VALUE 'C'.
017500         88  SRC-EXTERNAL-ENV-BLOCK  VALUE 'E'.
017600         88  SRC-ARCHIVE-FILE        VALUE 'A'.
017700     05  SRC-ENV-IO-TYPE             PIC X.
017800         88  SRC-SOURCE-LOCATION     VALUE 'I'.
017900         88  SRC-TARGET-LOCATION     VALUE 'O'.
018000     05  SRC-ENV-NEXT-ENV-POINTER    PIC 9(8) COMP SYNC.
018100     05  SRC-ENV-FILE-POINTER        PIC 9(8) COMP SYNC.
018200     05  SRC-ENV-SITE-NAME           PIC X.
018300     05  SRC-ENV-STAGE-ID            PIC X.
018400         88  SRC-STAGE-ONE           VALUE '1'.
018500         88  SRC-STAGE-TWO           VALUE '2'.
018600     05  SRC-ENV-STAGE-CODE          PIC X.
018700     05  FILLER                  PIC X.
018800     05  SRC-ENV-ELEMENT-VERSION     PIC 9(4) COMP SYNC.
018900     05  SRC-ENV-ELEMENT-LEVEL       PIC 9(4) COMP SYNC.
019000     05  SRC-ENV-ENVIRONMENT-NAME    PIC X(8).
019100     05  SRC-ENV-STAGE-NAME          PIC X(8).
019200     05  SRC-ENV-SYSTEM-NAME         PIC X(8).
019300     05  SRC-ENV-SYSTEM-DATA         PIC X(8).
019400     05  FILLER                      PIC X(8).
019500     05  SRC-ENV-SUBSYSTEM-NAME      PIC X(8).
019600     05  SRC-ENV-SUBSYSTEM-DATA      PIC X(8).
019700     05  SRC-ENV-TYPE-NAME           PIC X(8).
019800     05  SRC-ENV-TYPE-DATA           PIC X(8).
019900     05  SRC-ENV-ELEMENT-NAME        PIC X(10).
020000     05  FILLER                  PIC X(8).
020100*
020200*
020300*
020400 01  SRC-ELEMENT-MASTER-INFO-BLOCK.
020500     05  SRC-ELM-LENGTH              PIC 9(4) COMP SYNC.
020600     05  SRC-ELM-CURRENT-VERSION     PIC 9(4) COMP SYNC.
020700     05  SRC-ELM-BLOCK-ID            PIC X(4).
020800     05  SRC-ELM-FLAGS               PIC 9(8) COMP SYNC.
020900     05  SRC-ELM-ELEMENT-VERSION     PIC 9(4) COMP SYNC.
021000     05  SRC-ELM-ELEMENT-LEVEL       PIC 9(4) COMP SYNC.
021100     05  SRC-ELM-NUMBER-INSERTS      PIC 9(8) COMP SYNC.
021200     05  SRC-ELM-NUMBER-DELETES      PIC 9(8) COMP SYNC.
021300     05  SRC-ELM-ELEMENT-NAME        PIC X(10).
021400     05  SRC-ELM-CURRENT-CCID        PIC X(12).
021500     05  SRC-ELM-BASE-LEVEL-NUMBER   PIC 9(4) COMP SYNC.
021600     05  SRC-ELM-BASE-TOTAL-STMTS    PIC 9(8) COMP SYNC.
021700     05  SRC-ELM-BASE-DATE           PIC 9(6).
021800     05  SRC-ELM-BASE-TIME           PIC 9(4).
021900     05  SRC-ELM-BASE-COMMENT        PIC X(40).
022000     05  SRC-ELM-BASE-USERID         PIC X(8).
022100     05  SRC-ELM-GEN-USERID          PIC X(8).
022200     05  SRC-ELM-GEN-DATE            PIC 9(6).
022300     05  SRC-ELM-GEN-TIME            PIC 9(4).
022400     05  SRC-ELM-FROM-DSN            PIC X(44).
022500     05  SRC-ELM-FROM-MEMBER         PIC X(10).
022600     05  SRC-ELM-PROCESSOR-FLAG      PIC X.
022700     05  FILLER                  PIC X(3).
022800     05  SRC-ELM-PROCESSOR-LAST-DATE PIC 9(6).
022900     05  SRC-ELM-PROCESSOR-LAST-TIME PIC 9(4).
023000     05  SRC-ELM-PROCESSOR-USERID    PIC X(8).
023100     05  SRC-ELM-PROCESSOR-NAME      PIC X(10).
023200     05  SRC-ELM-PROCESSOR-RC        PIC 9(4) COMP SYNC.
023300     05  SRC-ELM-PROCESSOR-C1-RC     PIC 9(4) COMP SYNC.
023400     05  SRC-ELM-PROCESSOR-LAST-COMMENT PIC X(40).
023500     05  SRC-ELM-LEVEL-COMMENT       PIC X(40).
023600     05  SRC-ELM-LEVEL-DATE          PIC 9(6).
023700     05  SRC-ELM-LEVEL-TIME          PIC 9(4).
023800     05  SRC-ELM-LEVEL-USERID        PIC X(8).
023900     05  SRC-ELM-LAST-ACTION         PIC X(8).
024000     05  SRC-ELM-LAST-LEVEL-TOTAL    PIC 9(8) COMP SYNC.
024100     05  SRC-ELM-MOVE-DATE           PIC 9(6).
024200     05  SRC-ELM-MOVE-TIME           PIC 9(4).
024300     05  SRC-ELM-MOVE-USERID         PIC X(8).
024400     05  SRC-ELM-RETRIEVE-DATE       PIC 9(6).
024500     05  SRC-ELM-RETRIEVE-TIME       PIC 9(4).
024600     05  SRC-ELM-RETRIEVE-USERID     PIC X(8).
024700     05  SRC-ELM-RETRIEVE-COMMENT    PIC X(40).
024800     05  SRC-ELM-RETRIEVE-TO-DSN     PIC X(44).
024900     05  SRC-ELM-RETRIEVE-TO-MEMBER  PIC X(10).
025000     05  FILLER                  PIC X(30).
025100     05  SRC-ELM-RET-CCID            PIC X(12).
025200     05  SRC-ELM-GEN-CCID            PIC X(12).
025300     05  SRC-ELM-MOD-ACTION          PIC X(8).
025400     05  SRC-ELM-ACTION-CCID         PIC X(12).
025500     05  SRC-ELM-ACTION-COMM         PIC X(40).
025600     05  SRC-ELM-ACTION-USER         PIC X(8).
025700     05  SRC-ELM-ACTION-DATE         PIC 9(6).
025800     05  SRC-ELM-ACTIOM-TIME         PIC 9(4).
025900     05  SRC-ELM-SIGNOUT-ID          PIC X(8).
026000     05  SRC-ELM-LOC-FLAG            PIC X.
026100     05  SRC-ELM-FR-ACTION           PIC X(8).
026200     05  SRC-ELM-FR-ACT-USERID       PIC X(8).
026300     05  SRC-ELM-FR-ACT-DATE         PIC 9(6).
026400     05  SRC-ELM-FR-ACT-TIME         PIC 9(4).
026500     05  SRC-ELM-FR-SITE             PIC X.
026600     05  SRC-ELM-FR-ENV              PIC X(8).
026700     05  SRC-ELM-FR-SYS              PIC X(8).
026800     05  SRC-ELM-FR-SUBSYS           PIC X(8).
026900     05  SRC-ELM-FR-ELEMENT          PIC X(10).
027000     05  SRC-ELM-FR-TYPE             PIC X(8).
027100     05  SRC-ELM-FR-STG-NBR          PIC X.
027200     05  SRC-ELM-FR-VER              PIC 9(4) COMP SYNC.
027300     05  SRC-ELM-FR-LEVEL            PIC 9(4) COMP SYNC.
027400
027500* NEW ELEMENT FIELDS FOR E/MVS 3.6 FOLLOW
027600
027700     05  SRC-ELM-UPDATE-MEMBER-NAME  PIC X(10).
027800     05  SRC-ELM-BASE-MEMBER-NAME    PIC X(10).
027900     05  SRC-ELM-LOWER-LEVEL-IND     PIC X(2).
028000     05  SRC-ELM-PCT-PREV-INSERT-DEL PIC X.
028100     05  SRC-ELM-PCT-PREV-DELS-REINS PIC X.
028200     05  SRC-ELM-ESD-FP-NAME-IF-OBJ  PIC X(8).
028300     05  SRC-ELM-DELTA-FORMAT        PIC X.
028400         88  SRC-ELM-FORWARD-DELTA   VALUE 'F'.
028500         88  SRC-ELM-REVVERSE-DELTA  VALUE 'R'.
028600     05  SRC-ELM-PACKED-INDICATOR    PIC X.
028700         88  SRC-ELM-BASE-NOT-PACKED VALUE 'Y'.
028800     05  SRC-ELM-LAST-PROC-VERSION   PIC X.
028900     05  SRC-ELM-LAST-PROC-LEVEL     PIC X.
029000     05  SRC-ELM-RECORD-FORMAT       PIC X.
029100     05  SRC-ELM-CONF-DELTA-MEM-ID   PIC X(8).
029200     05  SRC-ELM-CONF-DELTA-VERSION  PIC S9(4) COMP SYNC.
029300     05  SRC-ELM-CONF-BASE-TOTAL     PIC S9(8) COMP SYNC.
029400     05  SRC-ELM-CONF-LAST-LVL-TOTAL PIC S9(8) COMP SYNC.
029500     05  SRC-ELM-CONF-BASE-LVL-NBR   PIC S9(4) COMP SYNC.
029600     05  SRC-ELM-CONF-LAST-LVL-NBR   PIC S9(4) COMP SYNC.
029700     05  SRC-ELM-INSERTS-LAST-LEVEL  PIC S9(4) COMP SYNC.
029800     05  SRC-ELM-DELETES-LAST-LEVEL  PIC S9(4) COMP SYNC.
029900     05  SRC-ELM-CONF-REGRES-INS-PCT PIC S9(4) COMP SYNC.
030000     05  SRC-ELM-CONF-REGRES-DEL-PCT PIC S9(4) COMP SYNC.
030100     05  SRC-ELM-CONF-BASE-DATE      PIC 9(6).
030200     05  SRC-ELM-CONF-BASE-TIME      PIC 9(4).
030300     05  SRC-ELM-CONF-LAST-LVL-DATE  PIC 9(6).
030400     05  SRC-ELM-CONF-LAST-LVL-TIME  PIC 9(4).
030500     05  SRC-ELM-CONF-COMP-STAT-FLAG PIC X.
030600     05  SRC-ELM-CONF-DELTA-FORMAT   PIC X.
030700     05  SRC-ELM-CONF-DELTA-BASE-FLG PIC X.
030800         88  SRC-ELM-CONF-BASE-IN-DELTA VALUE 'Y'.
030900     05  SRC-ELM-LAST-PROC-PACKAGE   PIC X(16).
031000     05  SRC-ELM-PACKAGE-TIMESTAMP1  PIC X(4).
031100     05  SRC-ELM-PACKAGE-TIMESTAMP2  PIC X(4).
031200     05  SRC-ELM-PACKAGE-WITH-OUTPUT PIC X(16).
031300     05  SRC-ELM-OPACKAGE-TIMESTAMP1 PIC X(4).
031400     05  SRC-ELM-OPACKAGE-TIMESTAMP2 PIC X(4).
031500     05  SRC-ELM-PROCESSOR-GROUP     PIC X(8).
031600
031700*
031800*
031900*
032000 01  SRC-FILE-CONTROL-BLOCK.
032100     05  SRC-FIL-LENGTH          PIC 9(4) COMP SYNC.
032200     05  SRC-FIL-CURRENT-VERSION PIC 9(4) COMP SYNC.
032300     05  SRC-FIL-BLOCK-ID        PIC X(4).
032400     05  SRC-FIL-DATASET-NAME    PIC X(44).
032500     05  SRC-FIL-DATASET-MEMBER  PIC X(10).
032600     05  SRC-FIL-DDNAME          PIC X(8).
032700     05  SRC-FIL-DATASET-TYPE    PIC X(3).
032800     05  FILLER              PIC X(21).
032900*
033000*
033100*
033200 01  TGT-ENVIRONMENT-BLOCK.
033300     05  TGT-ENV-LENGTH              PIC 9(4) COMP SYNC.
033400     05  TGT-ENV-CURRENT-VERSION     PIC 9(4) COMP SYNC.
033500     05  TGT-ENV-BLOCK-ID            PIC X(4).
033600     05  TGT-ENV-FLAGS               PIC 9(4) COMP SYNC.
033700     05  TGT-ENV-TYPE-OF-BLOCK       PIC X.
033800         88  TGT-INTERNAL-C1-BLOCK   VALUE 'C'.
033900         88  TGT-EXTERNAL-ENV-BLOCK  VALUE 'E'.
034000         88  TGT-ARCHIVE-FILE        VALUE 'A'.
034100     05  TGT-ENV-IO-TYPE             PIC X.
034200         88  TGT-SOURCE-LOCATION     VALUE 'I'.
034300         88  TGT-TARGET-LOCATION     VALUE 'O'.
034400     05  TGT-ENV-NEXT-ENV-POINTER    PIC 9(8) COMP SYNC.
034500     05  TGT-ENV-FILE-POINTER        PIC 9(8) COMP SYNC.
034600     05  TGT-ENV-SITE-NAME           PIC X.
034700     05  TGT-ENV-STAGE-ID            PIC X.
034800         88  TGT-STAGE-ONE           VALUE '1'.
034900         88  TGT-STAGE-TWO           VALUE '2'.
035000     05  TGT-ENV-STAGE-CODE          PIC X.
035100     05  TGT-ENV-ELEMENT-CHANGES     PIC X.
035200         88  TGT-SOURCE-CHANGES      VALUE 'Y'.
035300         88  TGT-NO-SOURCE-CHANGES   VALUE 'N'.
035400     05  TGT-ENV-ELEMENT-VERSION     PIC 9(4) COMP SYNC.
035500     05  TGT-ENV-ELEMENT-LEVEL       PIC 9(4) COMP SYNC.
035600     05  TGT-ENV-ENVIRONMENT-NAME    PIC X(8).
035700     05  TGT-ENV-STAGE-NAME          PIC X(8).
035800     05  TGT-ENV-SYSTEM-NAME         PIC X(8).
035900     05  TGT-ENV-SYSTEM-DATA         PIC X(8).
036000     05  FILLER                      PIC X(8).
036100     05  TGT-ENV-SUBSYSTEM-NAME      PIC X(8).
036200     05  TGT-ENV-SUBSYSTEM-DATA      PIC X(8).
036300     05  TGT-ENV-TYPE-NAME           PIC X(8).
036400     05  TGT-ENV-TYPE-DATA           PIC X(8).
036500     05  TGT-ENV-ELEMENT-NAME        PIC X(10).
036600     05  FILLER                  PIC X(8).
036700*
036800*
036900*
037000 01  TGT-ELEMENT-MASTER-INFO-BLOCK.
037100     05  TGT-ELM-LENGTH              PIC 9(4) COMP SYNC.
037200     05  TGT-ELM-CURRENT-VERSION     PIC 9(4) COMP SYNC.
037300     05  TGT-ELM-BLOCK-ID            PIC X(4).
037400     05  TGT-ELM-FLAGS               PIC 9(8) COMP SYNC.
037500     05  TGT-ELM-ELEMENT-VERSION     PIC 9(4) COMP SYNC.
037600     05  TGT-ELM-ELEMENT-LEVEL       PIC 9(4) COMP SYNC.
037700     05  TGT-ELM-NUMBER-INSERTS      PIC 9(8) COMP SYNC.
037800     05  TGT-ELM-NUMBER-DELETES      PIC 9(8) COMP SYNC.
037900     05  TGT-ELM-ELEMENT-NAME        PIC X(10).
038000     05  TGT-ELM-CURRENT-CCID        PIC X(12).
038100     05  TGT-ELM-BASE-LEVEL-NUMBER   PIC 9(4) COMP SYNC.
038200     05  TGT-ELM-BASE-TOTAL-STMTS    PIC 9(8) COMP SYNC.
038300     05  TGT-ELM-BASE-DATE           PIC 9(6).
038400     05  TGT-ELM-BASE-TIME           PIC 9(4).
038500     05  TGT-ELM-BASE-COMMENT        PIC X(40).
038600     05  TGT-ELM-BASE-USERID         PIC X(8).
038700     05  TGT-ELM-GEN-USERID          PIC X(8).
038800     05  TGT-ELM-GEN-DATE            PIC 9(6).
038900     05  TGT-ELM-GEN-TIME            PIC 9(4).
039000     05  TGT-ELM-FROM-DSN            PIC X(44).
039100     05  TGT-ELM-FROM-MEMBER         PIC X(10).
039200     05  TGT-ELM-PROCESSOR-FLAG      PIC X.
039300     05  FILLER                  PIC X(3).
039400     05  TGT-ELM-PROCESSOR-LAST-DATE PIC 9(6).
039500     05  TGT-ELM-PROCESSOR-LAST-TIME PIC 9(4).
039600     05  TGT-ELM-PROCESSOR-USERID    PIC X(8).
039700     05  TGT-ELM-PROCESSOR-NAME      PIC X(10).
039800     05  TGT-ELM-PROCESSOR-RC        PIC 9(4) COMP SYNC.
039900     05  TGT-ELM-PROCESSOR-C1-RC     PIC 9(4) COMP SYNC.
040000     05  TGT-ELM-PROCESSOR-LAST-COMMENT PIC X(40).
040100     05  TGT-ELM-LEVEL-COMMENT       PIC X(40).
040200     05  TGT-ELM-LEVEL-DATE          PIC 9(6).
040300     05  TGT-ELM-LEVEL-TIME          PIC 9(4).
040400     05  TGT-ELM-LEVEL-USERID        PIC X(8).
040500     05  TGT-ELM-LAST-ACTION         PIC X(8).
040600     05  TGT-ELM-LAST-LEVEL-TOTAL    PIC 9(8) COMP SYNC.
040700     05  TGT-ELM-MOVE-DATE           PIC 9(6).
040800     05  TGT-ELM-MOVE-TIME           PIC 9(4).
040900     05  TGT-ELM-MOVE-USERID         PIC X(8).
041000     05  TGT-ELM-RETRIEVE-DATE       PIC 9(6).
041100     05  TGT-ELM-RETRIEVE-TIME       PIC 9(4).
041200     05  TGT-ELM-RETRIEVE-USERID     PIC X(8).
041300     05  TGT-ELM-RETRIEVE-COMMENT    PIC X(40).
041400     05  TGT-ELM-RETRIEVE-TO-DSN     PIC X(44).
041500     05  TGT-ELM-RETRIEVE-TO-MEMBER  PIC X(10).
041600     05  FILLER                  PIC X(30).
041700     05  TGT-ELM-RET-CCID            PIC X(12).
041800     05  TGT-ELM-GEN-CCID            PIC X(12).
041900     05  TGT-ELM-MOD-ACTION          PIC X(8).
042000     05  TGT-ELM-ACTION-CCID         PIC X(12).
042100     05  TGT-ELM-ACTION-COMM         PIC X(40).
042200     05  TGT-ELM-ACTION-USER         PIC X(8).
042300     05  TGT-ELM-ACTION-DATE         PIC 9(6).
042400     05  TGT-ELM-ACTIOM-TIME         PIC 9(4).
042500     05  TGT-ELM-SIGNOUT-ID          PIC X(8).
042600     05  TGT-ELM-LOC-FLAG            PIC X.
042700     05  TGT-ELM-FR-ACTION           PIC X(8).
042800     05  TGT-ELM-FR-ACT-USERID       PIC X(8).
042900     05  TGT-ELM-FR-ACT-DATE         PIC 9(6).
043000     05  TGT-ELM-FR-ACT-TIME         PIC 9(4).
043100     05  TGT-ELM-FR-SITE             PIC X.
043200     05  TGT-ELM-FR-ENV              PIC X(8).
043300     05  TGT-ELM-FR-SYS              PIC X(8).
043400     05  TGT-ELM-FR-SUBSYS           PIC X(8).
043500     05  TGT-ELM-FR-ELEMENT          PIC X(10).
043600     05  TGT-ELM-FR-TYPE             PIC X(8).
043700     05  TGT-ELM-FR-STG-NBR          PIC X.
043800     05  TGT-ELM-FR-VER              PIC 9(4) COMP SYNC.
043900     05  TGT-ELM-FR-LEVEL            PIC 9(4) COMP SYNC.
044000
044100* NEW ELEMENT FIELDS FOR E/MVS 3.6 FOLLOW
044200
044300     05  TGT-ELM-UPDATE-MEMBER-NAME  PIC X(10).
044400     05  TGT-ELM-BASE-MEMBER-NAME    PIC X(10).
044500     05  TGT-ELM-LOWER-LEVEL-IND     PIC X(2).
044600     05  TGT-ELM-PCT-PREV-INSERT-DEL PIC X.
044700     05  TGT-ELM-PCT-PREV-DELS-REINS PIC X.
044800     05  TGT-ELM-ESD-FP-NAME-IF-OBJ  PIC X(8).
044900     05  TGT-ELM-DELTA-FORMAT        PIC X.
045000         88  TGT-ELM-FORWARD-DELTA   VALUE 'F'.
045100         88  TGT-ELM-REVVERSE-DELTA  VALUE 'R'.
045200     05  TGT-ELM-PACKED-INDICATOR    PIC X.
045300         88  TGT-ELM-BASE-NOT-PACKED VALUE 'Y'.
045400     05  TGT-ELM-LAST-PROC-VERSION   PIC X.
045500     05  TGT-ELM-LAST-PROC-LEVEL     PIC X.
045600     05  TGT-ELM-RECORD-FORMAT       PIC X.
045700     05  TGT-ELM-CONF-DELTA-MEM-ID   PIC X(8).
045800     05  TGT-ELM-CONF-DELTA-VERSION  PIC S9(4) COMP SYNC.
045900     05  TGT-ELM-CONF-BASE-TOTAL     PIC S9(8) COMP SYNC.
046000     05  TGT-ELM-CONF-LAST-LVL-TOTAL PIC S9(8) COMP SYNC.
046100     05  TGT-ELM-CONF-BASE-LVL-NBR   PIC S9(4) COMP SYNC.
046200     05  TGT-ELM-CONF-LAST-LVL-NBR   PIC S9(4) COMP SYNC.
046300     05  TGT-ELM-INSERTS-LAST-LEVEL  PIC S9(4) COMP SYNC.
046400     05  TGT-ELM-DELETES-LAST-LEVEL  PIC S9(4) COMP SYNC.
046500     05  TGT-ELM-CONF-REGRES-INS-PCT PIC S9(4) COMP SYNC.
046600     05  TGT-ELM-CONF-REGRES-DEL-PCT PIC S9(4) COMP SYNC.
046700     05  TGT-ELM-CONF-BASE-DATE      PIC 9(6).
046800     05  TGT-ELM-CONF-BASE-TIME      PIC 9(4).
046900     05  TGT-ELM-CONF-LAST-LVL-DATE  PIC 9(6).
047000     05  TGT-ELM-CONF-LAST-LVL-TIME  PIC 9(4).
047100     05  TGT-ELM-CONF-COMP-STAT-FLAG PIC X.
047200     05  TGT-ELM-CONF-DELTA-FORMAT   PIC X.
047300     05  TGT-ELM-CONF-DELTA-BASE-FLG PIC X.
047400         88  TGT-ELM-CONF-BASE-IN-DELTA VALUE 'Y'.
047500     05  TGT-ELM-LAST-PROC-PACKAGE   PIC X(16).
047600     05  TGT-ELM-PACKAGE-TIMESTAMP1  PIC X(4).
047700     05  TGT-ELM-PACKAGE-TIMESTAMP2  PIC X(4).
047800     05  TGT-ELM-PACKAGE-WITH-OUTPUT PIC X(16).
047900     05  TGT-ELM-OPACKAGE-TIMESTAMP1 PIC X(4).
048000     05  TGT-ELM-OPACKAGE-TIMESTAMP2 PIC X(4).
048100     05  TGT-ELM-PROCESSOR-GROUP     PIC X(8).
048200*
048300*
048400*
048500 01  TGT-FILE-CONTROL-BLOCK.
048600     05  TGT-FIL-LENGTH          PIC 9(4) COMP SYNC.
048700     05  TGT-FIL-CURRENT-VERSION PIC 9(4) COMP SYNC.
048800     05  TGT-FIL-BLOCK-ID        PIC X(4).
048900     05  TGT-FIL-DATASET-NAME    PIC X(44).
049000     05  TGT-FIL-DATASET-MEMBER  PIC X(10).
049100     05  TGT-FIL-DDNAME          PIC X(8).
049200     05  TGT-FIL-DATASET-TYPE    PIC X(3).
049300     05  FILLER              PIC X(21).
049600 PROCEDURE DIVISION USING EXIT-CONTROL-BLOCK,
049601                          REQUEST-INFO-BLOCK,
049602                          SRC-ENVIRONMENT-BLOCK,
049800                          SRC-ELEMENT-MASTER-INFO-BLOCK,
049900                          SRC-FILE-CONTROL-BLOCK,
050000                          TGT-ENVIRONMENT-BLOCK,
050100                          TGT-ELEMENT-MASTER-INFO-BLOCK,
050200                          TGT-FILE-CONTROL-BLOCK.
050210     IF RETRIEVE-ACTION AND
050211        SIGNOUT-OVERRIDE AND
050212        SRC-ELM-RETRIEVE-USERID NOT EQUAL TO '        ' AND             00
050213        SRC-ELM-LAST-ACTION = 'RETRIEVE'
050214           MOVE SRC-ELM-SIGNOUT-ID TO CURRENT-OWNER-USERID
050220           MOVE SRC-ELM-SIGNOUT-ID TO SIGNOUT-USERID
050230           MOVE SRC-ENV-ENVIRONMENT-NAME TO ENVIRONMENT-NAME
050231           MOVE SRC-ENV-SYSTEM-NAME TO SYSTEM-NAME
050232           MOVE SRC-ENV-SUBSYSTEM-NAME TO SUBSYSTEM-NAME
050293           MOVE SRC-ENV-ELEMENT-NAME TO ELEMENT-NAME
050294           CALL 'SNDEMAIL' USING EMAIL-MESSAGE.
050320     MOVE +0 TO ECB-RETURN-CODE.
050400     GOBACK.
